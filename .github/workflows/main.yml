# Ø§Ø³Ù… Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© GitHub Actions
name: The Wise Engineer (The Forge)

# ===================================================================
#  Ø§Ù„Ù…ÙØ´ØºÙ‘Ù„Ø§Øª (Triggers) - Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£Ù‡Ù… Ø§Ù„Ø°ÙŠ ÙŠØ­Ù„ Ù…Ø´ÙƒÙ„Ø© 422
# ===================================================================
on:
  # Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± ÙŠØ³Ù…Ø­ Ø¨ØªØ´ØºÙŠÙ„ Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ø¹Ø¨Ø± Ø§Ù„Ù€ API (Ù…Ù† ØªØ·Ø¨ÙŠÙ‚Ùƒ)
  workflow_dispatch:
    # Ù‡Ù†Ø§ Ù†ÙØ¹Ø±Ù‘Ù Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª (Inputs) Ø§Ù„ØªÙŠ Ù†ØªÙˆÙ‚Ø¹Ù‡Ø§ Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    inputs:
      target_owner:
        description: 'Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø°ÙŠ Ø³ÙŠØªÙ… ØªØ­Ø³ÙŠÙ†Ù‡'
        required: true
      target_repo:
        description: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø°ÙŠ Ø³ÙŠØªÙ… ØªØ­Ø³ÙŠÙ†Ù‡'
        required: true
      improvement_focus:
        description: 'Ù†ÙˆØ¹ Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Ù…Ø«Ø§Ù„: code_quality, documentation)'
        required: false
        default: 'all' # Ù‚ÙŠÙ…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ÙŠØ±Ø³Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø´ÙŠØ¦Ù‹Ø§

# ===================================================================
#  Ø§Ù„Ù…Ù‡Ø§Ù… (Jobs) - Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙŠ Ø³ÙŠÙ†ÙØ°Ù‡Ø§ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³
# ===================================================================
jobs:
  # Ø§Ø³Ù… Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  analyze-and-improve:
    # Ù†ÙˆØ¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙŠ Ø³ØªØ¹Ù…Ù„ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ù…Ù‡Ù…Ø© (Ø£Ø­Ø¯Ø« Ø¥ØµØ¯Ø§Ø± Ù…Ù† Ø£ÙˆØ¨ÙˆÙ†ØªÙˆ)
    runs-on: ubuntu-latest

    # Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ© Ù„Ù„Ù…Ù‡Ù…Ø©
    steps:
      # ---------------------------------------------------------------
      # Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø³Ø­Ø¨ ÙƒÙˆØ¯ "Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³" Ù†ÙØ³Ù‡ (Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹)
      # ---------------------------------------------------------------
      - name: 1. Checkout The Forge Code
        uses: actions/checkout@v4
        with:
          # Ù†Ø³Ø­Ø¨ ÙƒÙˆØ¯ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù
          repository: ${{ github.repository }}

      # ---------------------------------------------------------------
      # Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø³Ø­Ø¨ ÙƒÙˆØ¯ "Ø§Ù„Ù‡Ø¯Ù" (Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø°ÙŠ Ù†Ø±ÙŠØ¯ ØªØ­Ø³ÙŠÙ†Ù‡)
      # ---------------------------------------------------------------
      - name: 2. Checkout Target Repository Code
        uses: actions/checkout@v4
        with:
          # Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„ØªÙŠ Ø£Ø±Ø³Ù„Ù‡Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù‡Ø¯Ù
          repository: ${{ github.event.inputs.target_owner }}/${{ github.event.inputs.target_repo }}
          # Ù†Ø¶Ø¹ ÙƒÙˆØ¯ Ø§Ù„Ù‡Ø¯Ù ÙÙŠ Ù…Ø¬Ù„Ø¯ Ù…Ù†ÙØµÙ„ Ø§Ø³Ù…Ù‡ 'target' Ù„ØªØ¬Ù†Ø¨ ØªØ¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù„ÙØ§Øª
          path: 'target'

      # ---------------------------------------------------------------
      # Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Ø¹Ù…Ù„ Ø¨Ø§ÙŠØ«ÙˆÙ†
      # ---------------------------------------------------------------
      - name: 3. Setup Python Environment
        uses: actions/setup-python@v5
        with:
          python-version: '3.10' # ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ø¥ØµØ¯Ø§Ø± Ø¨Ø§ÙŠØ«ÙˆÙ† Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©

      # ---------------------------------------------------------------
      # Ø§Ù„Ø®Ø·ÙˆØ© 4: ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ù…Ø«Ù„ Ù…ÙƒØªØ¨Ø© OpenAI)
      # ---------------------------------------------------------------
      - name: 4. Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install openai # ØªØ«Ø¨ÙŠØª Ù…ÙƒØªØ¨Ø© OpenAI Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯

      # ---------------------------------------------------------------
      # Ø§Ù„Ø®Ø·ÙˆØ© 5: ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø°ÙƒÙŠ (Ø¬ÙˆÙ‡Ø± Ø¹Ù…Ù„ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³)
      # ---------------------------------------------------------------
      - name: 5. Run The Wise Engineer Script
        env:
          # ØªÙ…Ø±ÙŠØ± Ù…ÙØªØ§Ø­ API Ø§Ù„Ø®Ø§Øµ Ø¨Ù€ OpenAI ÙƒÙ…ØªØºÙŠØ± Ø¨ÙŠØ¦Ø© Ø¢Ù…Ù†
          # ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø¥Ø¶Ø§ÙØªÙ‡ ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ -> Secrets and variables -> Actions
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          # ØªÙ…Ø±ÙŠØ± Ù…Ø³Ø§Ø± Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù‡Ø¯Ù Ù„Ù„Ø³ÙƒØ±Ø¨Øª
          TARGET_DIR: 'target'
          # ØªÙ…Ø±ÙŠØ± Ù†ÙˆØ¹ Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
          IMPROVEMENT_FOCUS: ${{ github.event.inputs.improvement_focus }}
        run: |
          echo "=============================================="
          echo "ğŸš€ The Wise Engineer is starting its task..."
          echo "=============================================="
          echo "ğŸ¯ Analyzing repository: ${{ github.event.inputs.target_owner }}/${{ github.event.inputs.target_repo }}"
          echo "âš¡ Improvement focus: ${{ github.event.inputs.improvement_focus }}"
          echo "ğŸ“‚ Target code is located in: $(pwd)/target"
          
          # -----------------------------------------------------------------
          # Ù‡Ù†Ø§ ØªØ¶Ø¹ Ø§Ù„Ø£Ù…Ø± Ù„ØªØ´ØºÙŠÙ„ Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø¨Ø§ÙŠØ«ÙˆÙ† Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯
          # Ù…Ø«Ø§Ù„: python engineer_script.py
          # -----------------------------------------------------------------
          
          # ÙƒÙ…Ø«Ø§Ù„ Ø¨Ø³ÙŠØ·ØŒ Ø³Ù†Ù‚ÙˆÙ… ÙÙ‚Ø· Ø¨Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù‡Ø¯Ù
          echo "Listing files in the target repository:"
          ls -R target
          
          echo "=============================================="
          echo "âœ… The Wise Engineer has finished the analysis."
          echo "=============================================="

