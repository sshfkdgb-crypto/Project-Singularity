# ==============================================================================
# ==                  Genesis Forge - The AI Engineer                         ==
# ==             Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø§Ù„Ø°ÙƒÙŠ - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚                     ==
# ==============================================================================
#
# Ù‡Ø°Ø§ Ø§Ù„Ù€ Workflow Ù‡Ùˆ "Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³" Ø§Ù„Ø°ÙŠ ÙŠØ³ØªÙ‚Ø¨Ù„ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Forge Optimizer.
# Ø¥Ù†Ù‡ Ù…ØµÙ…Ù… Ù„ÙŠÙƒÙˆÙ† Ù…Ø±Ù†Ù‹Ø§ ÙˆÙŠØªÙƒÙŠÙ Ù…Ø¹ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© Ø§Ù„ØªÙŠ ÙŠØ±Ø³Ù„Ù‡Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.
#
# :ÙƒÙŠÙ ÙŠØ¹Ù…Ù„
# 1. ÙŠÙØ´ØºÙ‘ÙÙ„ Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø£Ù…Ø± "repository_dispatch" Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.
# 2. ÙŠÙ‚Ø±Ø£ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª: Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù‡Ø¯ÙØŒ Ø§Ù„ØªÙˆÙƒÙ†ØŒ ÙˆÙ†ÙˆØ¹ Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨.
# 3. ÙŠÙ‚ÙˆÙ… Ø¨Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù‡Ø¯Ù Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ø°ÙŠ ØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡.
# 4. ÙŠÙ†Ø´Ø¦ ÙØ±Ø¹Ù‹Ø§ Ø¬Ø¯ÙŠØ¯Ù‹Ø§ Ù„Ù„Ø¹Ù…Ù„ Ø¹Ù„ÙŠÙ‡ Ø¨Ø£Ù…Ø§Ù†.
# 5. ÙŠÙ‚ÙˆÙ… Ø¨Ø¥Ø¬Ø±Ø§Ø¡ "ØªØ­Ø³ÙŠÙ† ÙˆÙ‡Ù…ÙŠ" (Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯ ÙƒØ¯Ù„ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¬Ø§Ø­).
# 6. ÙŠÙ‚ÙˆÙ… Ø¨Ø¹Ù…Ù„ commit ÙˆØ¯ÙØ¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù‡Ø¯Ù.
#
# Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ«Ø¨Øª Ø£Ù† Ø§Ù„Ø¯ÙˆØ±Ø© ÙƒØ§Ù…Ù„Ø© (ØªØ·Ø¨ÙŠÙ‚ -> GitHub -> ØªØ¹Ø¯ÙŠÙ„ -> Ø­ÙØ¸).

name: 'ğŸ¤– Genesis Forge - AI Engineer'

# ------------------------------------------------------------------------------
# -- dÃ©clencheur (Ø§Ù„Ù…ÙØ´ØºÙ‘Ù„)
# ------------------------------------------------------------------------------
# ÙŠØ¹Ù…Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù€ Workflow ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ "repository_dispatch" Ø¥Ù„ÙŠÙ‡.
# Ù‡Ø°Ø§ Ù‡Ùˆ Ù…Ø§ ÙŠÙØ¹Ù„Ù‡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø°ÙƒÙŠ".
on:
  repository_dispatch:
    types: [code_quality, performance, error_handling, documentation, security, all]

# ------------------------------------------------------------------------------
# -- autorisations (Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª)
# ------------------------------------------------------------------------------
# Ù†Ø¹Ø·ÙŠ Ø§Ù„Ù€ Workflow Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù„Ø§Ø²Ù…Ø© Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆÙƒØªØ§Ø¨Ø© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª.
permissions:
  contents: write
  pull-requests: write

# ------------------------------------------------------------------------------
# -- TÃ¢ches (Ø§Ù„Ù…Ù‡Ø§Ù…)
# ------------------------------------------------------------------------------
jobs:
  optimize-repository:
    runs-on: ubuntu-latest
    
    steps:
      # -------------------------
      # -- Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ù„Ù„ØªØ­Ù‚Ù‚
      # -------------------------
      - name: 'ğŸ“¥ 1. Display Received Inputs'
        run: |
          echo "ğŸš€ The AI Engineer has been activated!"
          echo "----------------------------------------"
          echo "ğŸ¯ Target Repository Owner: ${{ github.event.client_payload.target_owner }}"
          echo "ğŸ¯ Target Repository Name: ${{ github.event.client_payload.target_repo }}"
          echo "âš¡ Improvement Type: ${{ github.event.client_payload.improvement_type }}"
          echo "ğŸ”‘ Target Token Provided: ${{ github.event.client_payload.target_token != '' }}"
          echo "----------------------------------------"

      # -------------------------
      # -- Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù‡Ø¯Ù
      # -------------------------
      # Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ø°ÙŠ Ø£Ø±Ø³Ù„Ù‡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù‡Ø¯Ù.
      - name: 'ğŸ“‚ 2. Clone Target Repository'
        uses: actions/checkout@v4
        with:
          repository: ${{ github.event.client_payload.target_owner }}/${{ github.event.client_payload.target_repo }}
          token: ${{ github.event.client_payload.target_token }} # Ø£Ù‡Ù… Ø¬Ø²Ø¡: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ù…Ø±Ø³Ù„
          path: 'target_project' # Ù†Ø¶Ø¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙÙŠ Ù…Ø¬Ù„Ø¯ Ù…Ù†ÙØµÙ„

      # -------------------------
      # -- Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ø¹Ø¯Ø§Ø¯ Git
      # -------------------------
      - name: 'ğŸ”§ 3. Configure Git'
        run: |
          cd target_project
          git config --global user.name 'Genesis Forge AI'
          git config --global user.email 'ai-engineer@users.noreply.github.com'

      # -------------------------
      # -- Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø¥Ù†Ø´Ø§Ø¡ ÙØ±Ø¹ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¹Ù…Ù„
      # -------------------------
      - name: 'ğŸŒ¿ 4. Create a New Branch'
        run: |
          cd target_project
          # Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
          BRANCH_NAME="forge-improvement-${{ github.event.client_payload.improvement_type }}-$(date +%s)"
          git checkout -b $BRANCH_NAME
          echo "âœ… Created and switched to branch: $BRANCH_NAME"

      # -------------------------
      # -- Ø§Ù„Ø®Ø·ÙˆØ© 5: Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ­Ø³ÙŠÙ† (Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù ÙƒØ¯Ù„ÙŠÙ„)
      # -------------------------
      # Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªÙŠ Ø³ÙŠØªÙ… ÙÙŠÙ‡Ø§ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ø§Ø­Ù‚Ù‹Ø§.
      # Ø­Ø§Ù„ÙŠÙ‹Ø§ØŒ Ø³Ù†Ù‚ÙˆÙ… ÙÙ‚Ø· Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù„Ø¥Ø«Ø¨Ø§Øª Ø£Ù†Ù†Ø§ Ù†Ø³ØªØ·ÙŠØ¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹.
      - name: 'âœ¨ 5. Perform Code Improvement (Simulation)'
        run: |
          cd target_project
          TIMESTAMP=$(date -u +"%Y-%m-%d %H:%M:%S UTC")
          IMPROVEMENT_TYPE="${{ github.event.client_payload.improvement_type }}"
          
          # Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ­Ø³ÙŠÙ†
          echo "## ğŸ¤– AI Improvement Report" > AI_IMPROVEMENT_REPORT.md
          echo "" >> AI_IMPROVEMENT_REPORT.md
          echo "**Timestamp:** $TIMESTAMP" >> AI_IMPROVEMENT_REPORT.md
          echo "**Improvement Type:** $IMPROVEMENT_TYPE" >> AI_IMPROVEMENT_REPORT.md
          echo "" >> AI_IMPROVEMENT_REPORT.md
          echo "This file was automatically generated by the Genesis Forge AI Engineer." >> AI_IMPROVEMENT_REPORT.md
          echo "This proves that the AI has successfully accessed and modified the repository." >> AI_IMPROVEMENT_REPORT.md
          echo "" >> AI_IMPROVEMENT_REPORT.md
          echo "Next step: Integrate a real AI model to modify actual code files." >> AI_IMPROVEMENT_REPORT.md
          
          echo "âœ… Created AI_IMPROVEMENT_REPORT.md"

      # -------------------------
      # -- Ø§Ù„Ø®Ø·ÙˆØ© 6: Ø­ÙØ¸ ÙˆØ¯ÙØ¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
      # -------------------------
      - name: 'ğŸ“¤ 6. Commit and Push Changes'
        run: |
          cd target_project
          git add .
          git commit -m "feat(ai): Perform automatic improvement for ${{ github.event.client_payload.improvement_type }}"
          git push origin HEAD
          echo "âœ…âœ…âœ… Successfully pushed changes to the target repository!"
          echo "ğŸ‰ The optimization cycle is complete and successful!"

